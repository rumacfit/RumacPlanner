<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Planner - Macca</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --color-bg: #fafaf9;
            --color-surface: #ffffff;
            --color-text: #1c1917;
            --color-text-light: #78716c;
            --color-border: #e7e5e4;
            
            --color-work: #0891b2;
            --color-work-light: #ecfeff;
            --color-training: #ea580c;
            --color-training-light: #fff7ed;
            --color-task: #7c3aed;
            --color-task-light: #faf5ff;
            --color-priority: #eab308;
            --color-priority-light: #fefce8;
            
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
        }

        .app-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--color-border);
        }

        .header h1 {
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: -0.015em;
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .mode-toggle {
            display: flex;
            gap: 0.5rem;
            background: var(--color-surface);
            padding: 0.25rem;
            border-radius: 0.5rem;
            box-shadow: var(--shadow-sm);
        }

        .mode-toggle button {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            color: var(--color-text-light);
            font-weight: 500;
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }

        .mode-toggle button.active {
            background: var(--color-text);
            color: white;
        }

        /* Weekly Overview */
        .weekly-section {
            margin-bottom: 2.5rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .import-buttons {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--color-text);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--color-surface);
            color: var(--color-text);
            border: 1px solid var(--color-border);
        }

        .btn-secondary:hover {
            background: var(--color-bg);
        }

        .week-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1rem;
        }

        .day-card {
            background: var(--color-surface);
            border-radius: 0.75rem;
            padding: 1.25rem;
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .day-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .day-card.active {
            border-color: var(--color-text);
            box-shadow: var(--shadow-lg);
        }

        .day-header {
            margin-bottom: 1rem;
        }

        .day-name {
            font-size: 0.875rem;
            color: var(--color-text-light);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .day-date {
            font-size: 1.5rem;
            font-weight: 700;
            margin-top: 0.25rem;
        }

        .day-badges {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .badge {
            padding: 0.375rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }

        .badge-work {
            background: var(--color-work-light);
            color: var(--color-work);
        }

        .badge-training {
            background: var(--color-training-light);
            color: var(--color-training);
        }

        .badge-tasks {
            background: var(--color-task-light);
            color: var(--color-task);
        }

        /* Daily Detail */
        .daily-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .panel {
            background: var(--color-surface);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--color-border);
        }

        .panel-title {
            font-size: 1.125rem;
            font-weight: 600;
        }

        /* Events & Schedule */
        .timeline {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .event-item {
            padding: 1rem;
            border-radius: 0.5rem;
            border-left: 4px solid;
        }

        .event-item.work {
            background: var(--color-work-light);
            border-color: var(--color-work);
        }

        .event-item.training {
            background: var(--color-training-light);
            border-color: var(--color-training);
        }

        .event-time {
            font-family: 'Space Mono', monospace;
            font-size: 0.875rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .event-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .event-detail {
            font-size: 0.875rem;
            color: var(--color-text-light);
        }

        /* Tasks */
        .priority-section {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--color-border);
        }

        .priority-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 0.75rem;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .task-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .task-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 0.75rem;
            background: white;
            border-radius: 0.375rem;
            transition: all 0.2s;
        }

        .task-item:hover {
            box-shadow: var(--shadow-sm);
        }

        .task-checkbox {
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid var(--color-border);
            border-radius: 0.25rem;
            cursor: pointer;
            flex-shrink: 0;
            margin-top: 0.125rem;
        }

        .task-checkbox.checked {
            background: var(--color-task);
            border-color: var(--color-task);
            position: relative;
        }

        .task-checkbox.checked::after {
            content: '✓';
            position: absolute;
            color: white;
            font-size: 0.875rem;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-weight: 500;
        }

        .task-title.completed {
            text-decoration: line-through;
            color: var(--color-text-light);
        }

        .completed-section {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--color-border);
        }

        .collapsed-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--color-text-light);
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.375rem;
            transition: background 0.2s;
        }

        .collapsed-header:hover {
            background: var(--color-bg);
        }

        .empty-state {
            text-align: center;
            padding: 2rem;
            color: var(--color-text-light);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.3;
        }

        /* Add buttons */
        .add-item-btn {
            width: 100%;
            padding: 0.75rem;
            background: var(--color-bg);
            border: 2px dashed var(--color-border);
            border-radius: 0.5rem;
            color: var(--color-text-light);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }

        .add-item-btn:hover {
            border-color: var(--color-text);
            color: var(--color-text);
            background: white;
        }

        /* Import Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal {
            background: var(--color-surface);
            border-radius: 1rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .modal-description {
            color: var(--color-text-light);
        }

        .upload-area {
            border: 3px dashed var(--color-border);
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 1rem;
        }

        .upload-area:hover {
            border-color: var(--color-text);
            background: var(--color-bg);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .modal-footer {
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .week-days {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 768px) {
            .week-days {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .daily-section {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function DailyPlanner() {
            const [currentUser, setCurrentUser] = useState(() => {
                return localStorage.getItem('currentUser') || 'macca';
            });
            const [mode, setMode] = useState('daily'); // daily, monthly, yearly, clients
            
            // Initialize with today's index (Monday-based)
            const getTodayIndex = () => {
                const jsDay = new Date().getDay();
                return jsDay === 0 ? 6 : jsDay - 1;
            };
            
            const [selectedDay, setSelectedDay] = useState(getTodayIndex());
            const [showImportModal, setShowImportModal] = useState(false);
            const [importType, setImportType] = useState(null);
            const [showCompletedTasks, setShowCompletedTasks] = useState(false);
            const [importText, setImportText] = useState('');
            const [showAddEventModal, setShowAddEventModal] = useState(false);
            const [showAddTaskModal, setShowAddTaskModal] = useState(false);
            const [newEvent, setNewEvent] = useState({ time: '', title: '', detail: '', type: 'work' });
            const [newTask, setNewTask] = useState({ title: '', priority: false });

            // Initialize default data structure
            const getDefaultWeekData = () => ({
                0: { events: [], tasks: [] },
                1: { events: [], tasks: [] },
                2: { events: [], tasks: [] },
                3: { events: [], tasks: [] },
                4: { events: [], tasks: [] },
                5: { events: [], tasks: [] },
                6: { events: [], tasks: [] }
            });

            // Sample data for Macca on first load
            const getMaccaSampleData = () => ({
                1: {
                    events: [
                        { id: Date.now() + 1, type: 'work', time: '09:00', title: 'Conditn Shift', detail: 'Studio Manager - Gladesville' },
                        { id: Date.now() + 2, type: 'training', time: '18:00', title: 'Hyrox Conditioning', detail: '60min - Running intervals' }
                    ],
                    tasks: [
                        { id: Date.now() + 3, title: 'Review week schedule with Ruby', completed: false, priority: true },
                        { id: Date.now() + 4, title: 'Update Rumac Fit client meal plans', completed: false, priority: true },
                        { id: Date.now() + 5, title: 'Check GoHighLevel webhook logs', completed: false, priority: true },
                        { id: Date.now() + 6, title: 'Reply to Conditn member emails', completed: false, priority: false }
                    ]
                },
                ...Object.fromEntries([0,2,3,4,5,6].map(i => [i, { events: [], tasks: [] }]))
            });

            // Load data from localStorage
            const loadUserData = (userId) => {
                const saved = localStorage.getItem(`planner_${userId}`);
                if (saved) {
                    return JSON.parse(saved);
                }
                // Return sample data for Macca on first load
                if (userId === 'macca') {
                    return getMaccaSampleData();
                }
                return getDefaultWeekData();
            };

            const [weekData, setWeekData] = useState(getDefaultWeekData());

            // Client tracker data
            const getDefaultClientData = () => ({
                clients: []
            });

            const loadClientData = (userId) => {
                const saved = localStorage.getItem(`clients_${userId}`);
                if (saved) {
                    return JSON.parse(saved);
                }
                return getDefaultClientData();
            };

            const [clientData, setClientData] = useState(getDefaultClientData());

            // Load client data on user change
            useEffect(() => {
                if (currentUser) {
                    setClientData(loadClientData(currentUser));
                }
            }, [currentUser]);

            // Save client data
            useEffect(() => {
                if (currentUser) {
                    localStorage.setItem(`clients_${currentUser}`, JSON.stringify(clientData));
                }
            }, [clientData, currentUser]);

            // Load user data on login
            useEffect(() => {
                if (currentUser) {
                    setWeekData(loadUserData(currentUser));
                }
            }, [currentUser]);

            // Save data to localStorage whenever weekData changes
            useEffect(() => {
                if (currentUser) {
                    localStorage.setItem(`planner_${currentUser}`, JSON.stringify(weekData));
                }
            }, [weekData, currentUser]);

            // Week starts on Monday
            const dayNames = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            const today = new Date();

            // Convert day index: 0=Mon, 1=Tue, ... 6=Sun
            const getTodayIndex = () => {
                const jsDay = today.getDay(); // 0=Sun, 1=Mon, ... 6=Sat
                return jsDay === 0 ? 6 : jsDay - 1; // Convert to 0=Mon, 6=Sun
            };

            const getDateForDay = (displayIndex) => {
                const date = new Date(today);
                const currentDayIndex = getTodayIndex();
                const diff = displayIndex - currentDayIndex;
                date.setDate(today.getDate() + diff);
                return date.getDate();
            };

            // Map display index (0=Mon) to data index (0=Sun, 1=Mon)
            const getDataIndex = (displayIndex) => {
                return displayIndex === 6 ? 0 : displayIndex + 1;
            };

            const currentDayData = weekData[getDataIndex(selectedDay)] || { events: [], tasks: [] };
            const priorityTasks = currentDayData.tasks.filter(t => t.priority && !t.completed);
            const regularTasks = currentDayData.tasks.filter(t => !t.priority && !t.completed);
            const completedTasks = currentDayData.tasks.filter(t => t.completed);

            const openImportModal = (type) => {
                setImportType(type);
                setShowImportModal(true);
            };

            const handleTextImport = () => {
                if (!importText.trim()) return;

                const lines = importText.trim().split('\n');
                const newData = { ...weekData };

                lines.forEach(line => {
                    const trimmed = line.trim();
                    if (!trimmed) return;

                    // Parse format: "Monday 9am Conditn Shift" or "Mon 18:00 Hyrox training"
                    const dayMatch = trimmed.match(/^(mon|tue|wed|thu|fri|sat|sun)/i);
                    if (!dayMatch) return;

                    const dayName = dayMatch[1].toLowerCase();
                    const dayIndex = ['mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun'].indexOf(dayName.substring(0, 3));
                    if (dayIndex === -1) return;

                    const dataIndex = dayIndex === 6 ? 0 : dayIndex + 1;

                    // Extract time (supports 9am, 9:00, 18:00, etc)
                    const timeMatch = trimmed.match(/(\d{1,2})(?::(\d{2}))?\s*(am|pm)?/i);
                    if (!timeMatch) return;

                    let hour = parseInt(timeMatch[1]);
                    const minute = timeMatch[2] || '00';
                    const meridian = timeMatch[3];

                    if (meridian) {
                        if (meridian.toLowerCase() === 'pm' && hour < 12) hour += 12;
                        if (meridian.toLowerCase() === 'am' && hour === 12) hour = 0;
                    }

                    const time = `${hour.toString().padStart(2, '0')}:${minute}`;

                    // Get the rest as title/detail
                    const rest = trimmed.substring(dayMatch[0].length + (timeMatch[0].length || 0)).trim();
                    const title = rest || 'Event';

                    // Determine type based on keywords
                    const lowerRest = rest.toLowerCase();
                    const type = lowerRest.includes('shift') || lowerRest.includes('work') || lowerRest.includes('conditn') 
                        ? 'work' 
                        : 'training';

                    // Add event
                    if (!newData[dataIndex].events) {
                        newData[dataIndex].events = [];
                    }

                    newData[dataIndex].events.push({
                        id: Date.now() + Math.random(),
                        type: type,
                        time: time,
                        title: title,
                        detail: ''
                    });
                });

                setWeekData(newData);
                setImportText('');
                setShowImportModal(false);
            };

            const handleAddEvent = () => {
                if (!newEvent.time || !newEvent.title) return;

                const dataIndex = getDataIndex(selectedDay);
                setWeekData(prev => ({
                    ...prev,
                    [dataIndex]: {
                        ...prev[dataIndex],
                        events: [...(prev[dataIndex].events || []), {
                            id: Date.now(),
                            ...newEvent
                        }]
                    }
                }));

                setNewEvent({ time: '', title: '', detail: '', type: 'work' });
                setShowAddEventModal(false);
            };

            const handleAddTask = () => {
                if (!newTask.title) return;

                const dataIndex = getDataIndex(selectedDay);
                setWeekData(prev => ({
                    ...prev,
                    [dataIndex]: {
                        ...prev[dataIndex],
                        tasks: [...(prev[dataIndex].tasks || []), {
                            id: Date.now(),
                            title: newTask.title,
                            completed: false,
                            priority: newTask.priority
                        }]
                    }
                }));

                setNewTask({ title: '', priority: false });
                setShowAddTaskModal(false);
            };

            const toggleTaskComplete = (taskId) => {
                const dataIndex = getDataIndex(selectedDay);
                setWeekData(prev => ({
                    ...prev,
                    [dataIndex]: {
                        ...prev[dataIndex],
                        tasks: prev[dataIndex].tasks.map(task =>
                            task.id === taskId ? { ...task, completed: !task.completed } : task
                        )
                    }
                }));
            };

            return (
                <div className="app-container">
                    {/* Header */}
                    <div className="header">
                        <div className="mode-toggle">
                            <button 
                                className={mode === 'daily' ? 'active' : ''}
                                onClick={() => setMode('daily')}
                            >
                                Daily
                            </button>
                            <button 
                                className={mode === 'monthly' ? 'active' : ''}
                                onClick={() => setMode('monthly')}
                            >
                                Monthly
                            </button>
                            <button 
                                className={mode === 'yearly' ? 'active' : ''}
                                onClick={() => setMode('yearly')}
                            >
                                Yearly
                            </button>
                            <button 
                                className={mode === 'clients' ? 'active' : ''}
                                onClick={() => setMode('clients')}
                            >
                                Client Tracker
                            </button>
                        </div>
                        <div className="header-controls">
                            <div className="mode-toggle">
                                <button 
                                    className={currentUser === 'macca' ? 'active' : ''}
                                    onClick={() => {
                                        setCurrentUser('macca');
                                        localStorage.setItem('currentUser', 'macca');
                                    }}
                                >
                                    Macca
                                </button>
                                <button 
                                    className={currentUser === 'ruby' ? 'active' : ''}
                                    onClick={() => {
                                        setCurrentUser('ruby');
                                        localStorage.setItem('currentUser', 'ruby');
                                    }}
                                >
                                    Ruby
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Content based on mode */}
                    {mode === 'daily' && (
                        <>

                    {/* Weekly Overview */}
                    <div className="weekly-section">
                        <div className="section-header">
                            <h2 className="section-title">Week Overview</h2>
                            <div className="import-buttons">
                                <button className="btn btn-secondary" onClick={() => openImportModal('text')}>
                                    Import Schedule
                                </button>
                            </div>
                        </div>

                        <div className="week-days">
                            {dayNames.map((day, displayIndex) => {
                                const dataIndex = getDataIndex(displayIndex);
                                const dayData = weekData[dataIndex] || { events: [], tasks: [] };
                                const workEvents = dayData.events.filter(e => e.type === 'work');
                                const trainingEvents = dayData.events.filter(e => e.type === 'training');
                                const incompleteTasks = dayData.tasks.filter(t => !t.completed).length;
                                const isToday = displayIndex === getTodayIndex();

                                return (
                                    <div 
                                        key={displayIndex}
                                        className={`day-card ${selectedDay === displayIndex ? 'active' : ''}`}
                                        onClick={() => setSelectedDay(displayIndex)}
                                    >
                                        <div className="day-header">
                                            <div className="day-name">{day}</div>
                                            <div className="day-date">{getDateForDay(displayIndex)}</div>
                                        </div>
                                        <div className="day-badges">
                                            {workEvents.length > 0 && (
                                                <div className="badge badge-work">
                                                    {workEvents.length} shift{workEvents.length > 1 ? 's' : ''}
                                                </div>
                                            )}
                                            {trainingEvents.length > 0 && (
                                                <div className="badge badge-training">
                                                    {trainingEvents.length} workout{trainingEvents.length > 1 ? 's' : ''}
                                                </div>
                                            )}
                                            {incompleteTasks > 0 && (
                                                <div className="badge badge-tasks">
                                                    {incompleteTasks} task{incompleteTasks > 1 ? 's' : ''}
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>

                    {/* Daily Detail */}
                    <div className="daily-section">
                        {/* Left: Events & Schedule */}
                        <div className="panel">
                            <div className="panel-header">
                                <h3 className="panel-title">
                                    {dayNames[selectedDay]}'s Schedule
                                </h3>
                                <button 
                                    className="btn btn-secondary" 
                                    style={{padding: '0.5rem 1rem', fontSize: '0.875rem'}}
                                    onClick={() => setShowAddEventModal(true)}
                                >
                                    + Add Event
                                </button>
                            </div>

                            {currentDayData.events.length > 0 ? (
                                <div className="timeline">
                                    {currentDayData.events.sort((a, b) => a.time.localeCompare(b.time)).map(event => (
                                        <div key={event.id} className={`event-item ${event.type}`}>
                                            <div className="event-time">{event.time}</div>
                                            <div className="event-title">{event.title}</div>
                                            <div className="event-detail">{event.detail}</div>
                                        </div>
                                    ))}
                                </div>
                            ) : (
                                <div className="empty-state">
                                    <p>No events scheduled for this day</p>
                                </div>
                            )}
                        </div>

                        {/* Right: Tasks */}
                        <div className="panel">
                            <div className="panel-header">
                                <h3 className="panel-title">Tasks & Priorities</h3>
                                <button 
                                    className="btn btn-secondary" 
                                    style={{padding: '0.5rem 1rem', fontSize: '0.875rem'}}
                                    onClick={() => setShowAddTaskModal(true)}
                                >
                                    + Add Task
                                </button>
                            </div>

                            {/* Top 3 Priorities */}
                            {priorityTasks.length > 0 && (
                                <div className="priority-section">
                                    <div className="priority-label">
                                        Top 3 Priorities
                                    </div>
                                    <div className="task-list">
                                        {priorityTasks.map(task => (
                                            <div key={task.id} className="task-item">
                                                <div 
                                                    className={`task-checkbox ${task.completed ? 'checked' : ''}`}
                                                    onClick={() => toggleTaskComplete(task.id)}
                                                />
                                                <div className="task-content">
                                                    <div className={`task-title ${task.completed ? 'completed' : ''}`}>
                                                        {task.title}
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* Regular Tasks */}
                            {regularTasks.length > 0 && (
                                <div className="task-list">
                                    {regularTasks.map(task => (
                                        <div key={task.id} className="task-item">
                                            <div 
                                                className={`task-checkbox ${task.completed ? 'checked' : ''}`}
                                                onClick={() => toggleTaskComplete(task.id)}
                                            />
                                            <div className="task-content">
                                                <div className={`task-title ${task.completed ? 'completed' : ''}`}>
                                                    {task.title}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {priorityTasks.length === 0 && regularTasks.length === 0 && (
                                <div className="empty-state">
                                    <div className="empty-state-icon">✓</div>
                                    <p>No tasks for this day</p>
                                </div>
                            )}

                            {/* Completed Tasks */}
                            {completedTasks.length > 0 && (
                                <div className="completed-section">
                                    <div 
                                        className="collapsed-header"
                                        onClick={() => setShowCompletedTasks(!showCompletedTasks)}
                                    >
                                        <span>{showCompletedTasks ? '▼' : '▶'}</span>
                                        <span>Completed ({completedTasks.length})</span>
                                    </div>
                                    {showCompletedTasks && (
                                        <div className="task-list" style={{marginTop: '0.75rem'}}>
                                            {completedTasks.map(task => (
                                                <div key={task.id} className="task-item">
                                                    <div 
                                                        className="task-checkbox checked"
                                                        onClick={() => toggleTaskComplete(task.id)}
                                                    />
                                                    <div className="task-content">
                                                        <div className="task-title completed">
                                                            {task.title}
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            )}
                        </div>
                    </div>
                    </>
                    )}

                    {/* Monthly View */}
                    {mode === 'monthly' && (
                        <div style={{textAlign: 'center', padding: '3rem', color: 'var(--color-text-light)'}}>
                            <p>Monthly view - Coming soon</p>
                        </div>
                    )}

                    {/* Yearly View */}
                    {mode === 'yearly' && (
                        <div style={{textAlign: 'center', padding: '3rem', color: 'var(--color-text-light)'}}>
                            <p>Yearly view - Coming soon</p>
                        </div>
                    )}

                    {/* Client Tracker View */}
                    {mode === 'clients' && (
                        <div style={{marginTop: '1rem'}}>
                            <div className="section-header">
                                <h2 className="section-title">Client Tracker - 4 Week Test ($29)</h2>
                                <button className="btn btn-primary" onClick={() => {
                                    const name = prompt('Client name:');
                                    if (name) {
                                        setClientData(prev => ({
                                            clients: [...prev.clients, {
                                                id: Date.now(),
                                                name: name,
                                                startDate: new Date().toISOString(),
                                                week: 1,
                                                status: 'active'
                                            }]
                                        }));
                                    }
                                }}>
                                    + Add Client
                                </button>
                            </div>

                            <div style={{display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '1.5rem', marginTop: '1.5rem'}}>
                                {[1,2,3,4].map(week => {
                                    const weekClients = clientData.clients.filter(c => c.week === week && c.status === 'active');
                                    return (
                                        <div key={week} style={{
                                            background: 'var(--color-surface)',
                                            borderRadius: '0.75rem',
                                            boxShadow: 'var(--shadow-sm)',
                                            minHeight: '300px'
                                        }}>
                                            <div style={{
                                                padding: '1rem',
                                                background: 'var(--color-bg)',
                                                borderTopLeftRadius: '0.75rem',
                                                borderTopRightRadius: '0.75rem',
                                                borderBottom: '2px solid var(--color-border)',
                                                fontWeight: '600',
                                                fontSize: '0.875rem',
                                                textTransform: 'uppercase',
                                                letterSpacing: '0.05em'
                                            }}>
                                                Week {week}
                                            </div>
                                            <div style={{padding: '1rem'}}>
                                                {weekClients.length > 0 ? (
                                                    <div style={{display: 'flex', flexDirection: 'column', gap: '0.5rem'}}>
                                                        {weekClients.map(client => (
                                                            <div key={client.id} style={{
                                                                padding: '0.75rem',
                                                                background: 'var(--color-work-light)',
                                                                borderRadius: '0.375rem',
                                                                borderLeft: '3px solid var(--color-work)',
                                                                display: 'flex',
                                                                justifyContent: 'space-between',
                                                                alignItems: 'center'
                                                            }}>
                                                                <span style={{fontWeight: '500', fontSize: '0.875rem'}}>{client.name}</span>
                                                                <div style={{display: 'flex', gap: '0.25rem'}}>
                                                                    {week < 4 && (
                                                                        <button 
                                                                            className="btn btn-secondary"
                                                                            style={{
                                                                                padding: '0.25rem 0.5rem',
                                                                                fontSize: '0.75rem',
                                                                                minWidth: 'auto'
                                                                            }}
                                                                            onClick={() => {
                                                                                setClientData(prev => ({
                                                                                    clients: prev.clients.map(c => 
                                                                                        c.id === client.id ? {...c, week: c.week + 1} : c
                                                                                    )
                                                                                }));
                                                                            }}
                                                                            title="Move to next week"
                                                                        >
                                                                            →
                                                                        </button>
                                                                    )}
                                                                    <button 
                                                                        className="btn btn-secondary"
                                                                        style={{
                                                                            padding: '0.25rem 0.5rem',
                                                                            fontSize: '0.75rem',
                                                                            minWidth: 'auto',
                                                                            background: 'var(--color-text-light)',
                                                                            color: 'white'
                                                                        }}
                                                                        onClick={() => {
                                                                            if (confirm(`Remove ${client.name}?`)) {
                                                                                setClientData(prev => ({
                                                                                    clients: prev.clients.filter(c => c.id !== client.id)
                                                                                }));
                                                                            }
                                                                        }}
                                                                        title="Remove client"
                                                                    >
                                                                        ×
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                ) : (
                                                    <div style={{textAlign: 'center', padding: '2rem', color: 'var(--color-text-light)', fontSize: '0.875rem'}}>
                                                        No clients
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    )}

                    {/* Add Event Modal */}
                    {showAddEventModal && (
                        <div className="modal-overlay" onClick={() => setShowAddEventModal(false)}>
                            <div className="modal" onClick={e => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h3 className="modal-title">Add Event</h3>
                                </div>
                                <div style={{display: 'flex', flexDirection: 'column', gap: '1rem'}}>
                                    <input
                                        type="time"
                                        value={newEvent.time}
                                        onChange={(e) => setNewEvent({...newEvent, time: e.target.value})}
                                        style={{padding: '0.75rem', borderRadius: '0.375rem', border: '2px solid var(--color-border)', fontSize: '0.875rem', fontFamily: 'inherit'}}
                                    />
                                    <input
                                        type="text"
                                        value={newEvent.title}
                                        onChange={(e) => setNewEvent({...newEvent, title: e.target.value})}
                                        placeholder="Event title"
                                        style={{padding: '0.75rem', borderRadius: '0.375rem', border: '2px solid var(--color-border)', fontSize: '0.875rem', fontFamily: 'inherit'}}
                                    />
                                    <input
                                        type="text"
                                        value={newEvent.detail}
                                        onChange={(e) => setNewEvent({...newEvent, detail: e.target.value})}
                                        placeholder="Details (optional)"
                                        style={{padding: '0.75rem', borderRadius: '0.375rem', border: '2px solid var(--color-border)', fontSize: '0.875rem', fontFamily: 'inherit'}}
                                    />
                                    <select
                                        value={newEvent.type}
                                        onChange={(e) => setNewEvent({...newEvent, type: e.target.value})}
                                        style={{padding: '0.75rem', borderRadius: '0.375rem', border: '2px solid var(--color-border)', fontSize: '0.875rem', fontFamily: 'inherit'}}
                                    >
                                        <option value="work">Work</option>
                                        <option value="training">Training</option>
                                    </select>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => setShowAddEventModal(false)}>Cancel</button>
                                    <button className="btn btn-primary" onClick={handleAddEvent}>Add Event</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Add Task Modal */}
                    {showAddTaskModal && (
                        <div className="modal-overlay" onClick={() => setShowAddTaskModal(false)}>
                            <div className="modal" onClick={e => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h3 className="modal-title">Add Task</h3>
                                </div>
                                <div style={{display: 'flex', flexDirection: 'column', gap: '1rem'}}>
                                    <input
                                        type="text"
                                        value={newTask.title}
                                        onChange={(e) => setNewTask({...newTask, title: e.target.value})}
                                        placeholder="Task description"
                                        style={{padding: '0.75rem', borderRadius: '0.375rem', border: '2px solid var(--color-border)', fontSize: '0.875rem', fontFamily: 'inherit'}}
                                    />
                                    <label style={{display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer'}}>
                                        <input
                                            type="checkbox"
                                            checked={newTask.priority}
                                            onChange={(e) => setNewTask({...newTask, priority: e.target.checked})}
                                        />
                                        <span>Mark as priority</span>
                                    </label>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => setShowAddTaskModal(false)}>Cancel</button>
                                    <button className="btn btn-primary" onClick={handleAddTask}>Add Task</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Import Modal */}
                    {showImportModal && (
                        <div className="modal-overlay" onClick={() => setShowImportModal(false)}>
                            <div className="modal" onClick={e => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h3 className="modal-title">Import Schedule</h3>
                                    <p className="modal-description">
                                        Paste your schedule below. Each line should start with a day and time, followed by the event details.
                                    </p>
                                </div>

                                <div style={{marginBottom: '1rem'}}>
                                    <p style={{fontSize: '0.875rem', color: 'var(--color-text-light)', marginBottom: '0.5rem'}}>
                                        <strong>Format examples:</strong>
                                    </p>
                                    <div style={{
                                        background: 'var(--color-bg)',
                                        padding: '0.75rem',
                                        borderRadius: '0.5rem',
                                        fontSize: '0.875rem',
                                        fontFamily: 'monospace',
                                        color: 'var(--color-text-light)'
                                    }}>
                                        Monday 9am Conditn Shift<br/>
                                        Mon 18:00 Hyrox training<br/>
                                        Tuesday 06:00 Strength workout<br/>
                                        Wed 9:30am Work meeting
                                    </div>
                                </div>

                                <textarea
                                    value={importText}
                                    onChange={(e) => setImportText(e.target.value)}
                                    placeholder="Paste your schedule here..."
                                    style={{
                                        width: '100%',
                                        minHeight: '200px',
                                        padding: '1rem',
                                        borderRadius: '0.5rem',
                                        border: '2px solid var(--color-border)',
                                        fontFamily: 'inherit',
                                        fontSize: '0.875rem',
                                        resize: 'vertical'
                                    }}
                                />

                                <div className="modal-footer">
                                    <button 
                                        className="btn btn-secondary"
                                        onClick={() => {
                                            setShowImportModal(false);
                                            setImportText('');
                                        }}
                                    >
                                        Cancel
                                    </button>
                                    <button 
                                        className="btn btn-primary"
                                        onClick={handleTextImport}
                                    >
                                        Import Schedule
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function App() {
            return <DailyPlanner />;
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
